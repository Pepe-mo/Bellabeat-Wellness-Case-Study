Bellabeat project
================
Pepe Nwahizu
June 21, 2024

# Case Study: How do Consumers Use Non-Bellabeat smart device

## ASk phase

Business Task: The business task is to conduct a comprehensive analysis
of smart device usage data for Fitbit. The goal is to extract actionable
insights that can inform and enhance the Bellabeat’s marketing strategy,
thereby driving growth and increasing user engagement and retention.

Key Stakeholders: Urška Sršen - Co-founder and Chief Creative Officer of
Bellabeat Sando Mur - Co-founder and key member of Bellabeat executive
team Bellabeat Marketing team

## Prepare Phase

Data was generated by respondents to a distributed survey conducted via
Amazon Mechanical Turk between December 3, 2016, and December 5, 2016.
Thirty eligible Fitbit users consented to submit their personal tracker
data, which included minute-level output for physical activity, heart
rate, and sleep monitoring. Data is under the license:
<https://creativecommons.org/publicdomain/zero/1.0/>

\##Process Phase

### Importing and cleaning data

``` r
install.packages("tidyverse")
```

    ## Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
    ## (as 'lib' is unspecified)

``` r
install.packages("skimr")
```

    ## Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
    ## (as 'lib' is unspecified)

``` r
install.packages("janitor")
```

    ## Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
    ## (as 'lib' is unspecified)

``` r
install.packages("readr")
```

    ## Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
    ## (as 'lib' is unspecified)

``` r
library("tidyverse")
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library("skimr")
library("janitor")
```

    ## 
    ## Attaching package: 'janitor'
    ## 
    ## The following objects are masked from 'package:stats':
    ## 
    ##     chisq.test, fisher.test

``` r
library("readr")
```

### Import data

``` r
dailyActivity31216 <- read_csv("mturkfitbit_export_3.12.16-4.11.16/Fitabase Data 3.12.16-4.11.16/dailyActivity_merged.csv")
```

    ## Rows: 457 Columns: 15
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr  (1): ActivityDate
    ## dbl (14): Id, TotalSteps, TotalDistance, TrackerDistance, LoggedActivitiesDi...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(dailyActivity31216)
```

    ## # A tibble: 6 × 15
    ##           Id ActivityDate TotalSteps TotalDistance TrackerDistance
    ##        <dbl> <chr>             <dbl>         <dbl>           <dbl>
    ## 1 1503960366 3/25/2016         11004          7.11            7.11
    ## 2 1503960366 3/26/2016         17609         11.6            11.6 
    ## 3 1503960366 3/27/2016         12736          8.53            8.53
    ## 4 1503960366 3/28/2016         13231          8.93            8.93
    ## 5 1503960366 3/29/2016         12041          7.85            7.85
    ## 6 1503960366 3/30/2016         10970          7.16            7.16
    ## # ℹ 10 more variables: LoggedActivitiesDistance <dbl>,
    ## #   VeryActiveDistance <dbl>, ModeratelyActiveDistance <dbl>,
    ## #   LightActiveDistance <dbl>, SedentaryActiveDistance <dbl>,
    ## #   VeryActiveMinutes <dbl>, FairlyActiveMinutes <dbl>,
    ## #   LightlyActiveMinutes <dbl>, SedentaryMinutes <dbl>, Calories <dbl>

``` r
weightLogInfo31216 <- read_csv("mturkfitbit_export_3.12.16-4.11.16/Fitabase Data 3.12.16-4.11.16/weightLogInfo_merged.csv")
```

    ## Rows: 33 Columns: 8
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Date
    ## dbl (6): Id, WeightKg, WeightPounds, Fat, BMI, LogId
    ## lgl (1): IsManualReport
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(weightLogInfo31216)
```

    ## # A tibble: 6 × 8
    ##           Id Date       WeightKg WeightPounds   Fat   BMI IsManualReport   LogId
    ##        <dbl> <chr>         <dbl>        <dbl> <dbl> <dbl> <lgl>            <dbl>
    ## 1 1503960366 4/5/2016 …     53.3         118.    22  23.0 TRUE           1.46e12
    ## 2 1927972279 4/10/2016…    130.          286.    NA  46.2 FALSE          1.46e12
    ## 3 2347167796 4/3/2016 …     63.4         140.    10  24.8 TRUE           1.46e12
    ## 4 2873212765 4/6/2016 …     56.7         125.    NA  21.5 TRUE           1.46e12
    ## 5 2873212765 4/7/2016 …     57.2         126.    NA  21.6 TRUE           1.46e12
    ## 6 2891001357 4/5/2016 …     88.4         195.    NA  25.0 TRUE           1.46e12

``` r
SleepLog31216 <- read_csv("mturkfitbit_export_3.12.16-4.11.16/Fitabase Data 3.12.16-4.11.16/minuteSleep_merged.csv")
```

    ## Rows: 198559 Columns: 4
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (3): Id, value, logId
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
dailyActivity41216 <- read.csv("mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv")
```

``` r
weightLog41216 <- read_csv("mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv")
```

    ## Rows: 67 Columns: 8
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Date
    ## dbl (6): Id, WeightKg, WeightPounds, Fat, BMI, LogId
    ## lgl (1): IsManualReport
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(weightLog41216)
```

    ## # A tibble: 6 × 8
    ##           Id Date       WeightKg WeightPounds   Fat   BMI IsManualReport   LogId
    ##        <dbl> <chr>         <dbl>        <dbl> <dbl> <dbl> <lgl>            <dbl>
    ## 1 1503960366 5/2/2016 …     52.6         116.    22  22.6 TRUE           1.46e12
    ## 2 1503960366 5/3/2016 …     52.6         116.    NA  22.6 TRUE           1.46e12
    ## 3 1927972279 4/13/2016…    134.          294.    NA  47.5 FALSE          1.46e12
    ## 4 2873212765 4/21/2016…     56.7         125.    NA  21.5 TRUE           1.46e12
    ## 5 2873212765 5/12/2016…     57.3         126.    NA  21.7 TRUE           1.46e12
    ## 6 4319703577 4/17/2016…     72.4         160.    25  27.5 TRUE           1.46e12

``` r
sleepDay41216 <- read_csv("mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv")
```

    ## Rows: 413 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): SleepDay
    ## dbl (4): Id, TotalSleepRecords, TotalMinutesAsleep, TotalTimeInBed
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(sleepDay41216)
```

    ## # A tibble: 6 × 5
    ##           Id SleepDay        TotalSleepRecords TotalMinutesAsleep TotalTimeInBed
    ##        <dbl> <chr>                       <dbl>              <dbl>          <dbl>
    ## 1 1503960366 4/12/2016 12:0…                 1                327            346
    ## 2 1503960366 4/13/2016 12:0…                 2                384            407
    ## 3 1503960366 4/15/2016 12:0…                 1                412            442
    ## 4 1503960366 4/16/2016 12:0…                 2                340            367
    ## 5 1503960366 4/17/2016 12:0…                 1                700            712
    ## 6 1503960366 4/19/2016 12:0…                 1                304            320

### Inspecting data

``` r
colnames(dailyActivity31216)
```

    ##  [1] "Id"                       "ActivityDate"            
    ##  [3] "TotalSteps"               "TotalDistance"           
    ##  [5] "TrackerDistance"          "LoggedActivitiesDistance"
    ##  [7] "VeryActiveDistance"       "ModeratelyActiveDistance"
    ##  [9] "LightActiveDistance"      "SedentaryActiveDistance" 
    ## [11] "VeryActiveMinutes"        "FairlyActiveMinutes"     
    ## [13] "LightlyActiveMinutes"     "SedentaryMinutes"        
    ## [15] "Calories"

``` r
colnames(dailyActivity41216)
```

    ##  [1] "Id"                       "ActivityDate"            
    ##  [3] "TotalSteps"               "TotalDistance"           
    ##  [5] "TrackerDistance"          "LoggedActivitiesDistance"
    ##  [7] "VeryActiveDistance"       "ModeratelyActiveDistance"
    ##  [9] "LightActiveDistance"      "SedentaryActiveDistance" 
    ## [11] "VeryActiveMinutes"        "FairlyActiveMinutes"     
    ## [13] "LightlyActiveMinutes"     "SedentaryMinutes"        
    ## [15] "Calories"

``` r
colnames(SleepLog31216)
```

    ## [1] "Id"    "date"  "value" "logId"

``` r
colnames(sleepDay41216)
```

    ## [1] "Id"                 "SleepDay"           "TotalSleepRecords" 
    ## [4] "TotalMinutesAsleep" "TotalTimeInBed"

``` r
colnames(weightLogInfo31216)
```

    ## [1] "Id"             "Date"           "WeightKg"       "WeightPounds"  
    ## [5] "Fat"            "BMI"            "IsManualReport" "LogId"

``` r
colnames(weightLog41216)
```

    ## [1] "Id"             "Date"           "WeightKg"       "WeightPounds"  
    ## [5] "Fat"            "BMI"            "IsManualReport" "LogId"

### Merging & cleaning data

``` r
Combined_dailyActivity <- rbind(dailyActivity31216, dailyActivity41216)
Combined_weightLog <- rbind(weightLogInfo31216, weightLog41216)
```

### View and inspect new combined data sets

``` r
view(Combined_dailyActivity)
view(Combined_weightLog)
```

``` r
glimpse(Combined_dailyActivity)
```

    ## Rows: 1,397
    ## Columns: 15
    ## $ Id                       <dbl> 1503960366, 1503960366, 1503960366, 150396036…
    ## $ ActivityDate             <chr> "3/25/2016", "3/26/2016", "3/27/2016", "3/28/…
    ## $ TotalSteps               <dbl> 11004, 17609, 12736, 13231, 12041, 10970, 122…
    ## $ TotalDistance            <dbl> 7.11, 11.55, 8.53, 8.93, 7.85, 7.16, 7.86, 7.…
    ## $ TrackerDistance          <dbl> 7.11, 11.55, 8.53, 8.93, 7.85, 7.16, 7.86, 7.…
    ## $ LoggedActivitiesDistance <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
    ## $ VeryActiveDistance       <dbl> 2.57, 6.92, 4.66, 3.19, 2.16, 2.36, 2.29, 3.3…
    ## $ ModeratelyActiveDistance <dbl> 0.46, 0.73, 0.16, 0.79, 1.09, 0.51, 0.49, 0.8…
    ## $ LightActiveDistance      <dbl> 4.07, 3.91, 3.71, 4.95, 4.61, 4.29, 5.04, 3.6…
    ## $ SedentaryActiveDistance  <dbl> 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.0…
    ## $ VeryActiveMinutes        <dbl> 33, 89, 56, 39, 28, 30, 33, 47, 40, 15, 43, 3…
    ## $ FairlyActiveMinutes      <dbl> 12, 17, 5, 20, 28, 13, 12, 21, 11, 30, 18, 18…
    ## $ LightlyActiveMinutes     <dbl> 205, 274, 268, 224, 243, 223, 239, 200, 244, …
    ## $ SedentaryMinutes         <dbl> 804, 588, 605, 1080, 763, 1174, 820, 866, 636…
    ## $ Calories                 <dbl> 1819, 2154, 1944, 1932, 1886, 1820, 1889, 186…

``` r
glimpse(Combined_weightLog)
```

    ## Rows: 100
    ## Columns: 8
    ## $ Id             <dbl> 1503960366, 1927972279, 2347167796, 2873212765, 2873212…
    ## $ Date           <chr> "4/5/2016 11:59:59 PM", "4/10/2016 6:33:26 PM", "4/3/20…
    ## $ WeightKg       <dbl> 53.3, 129.6, 63.4, 56.7, 57.2, 88.4, 92.4, 69.4, 99.7, …
    ## $ WeightPounds   <dbl> 117.5064, 285.7191, 139.7731, 125.0021, 126.1044, 194.8…
    ## $ Fat            <dbl> 22, NA, 10, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ BMI            <dbl> 22.97, 46.17, 24.77, 21.45, 21.65, 25.03, 35.01, 27.14,…
    ## $ IsManualReport <lgl> TRUE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, …
    ## $ LogId          <dbl> 1.459901e+12, 1.460313e+12, 1.459728e+12, 1.459987e+12,…

``` r
summary(Combined_dailyActivity)
```

    ##        Id            ActivityDate         TotalSteps    TotalDistance   
    ##  Min.   :1.504e+09   Length:1397        Min.   :    0   Min.   : 0.000  
    ##  1st Qu.:2.320e+09   Class :character   1st Qu.: 3146   1st Qu.: 2.170  
    ##  Median :4.445e+09   Mode  :character   Median : 6999   Median : 4.950  
    ##  Mean   :4.781e+09                      Mean   : 7281   Mean   : 5.219  
    ##  3rd Qu.:6.962e+09                      3rd Qu.:10544   3rd Qu.: 7.500  
    ##  Max.   :8.878e+09                      Max.   :36019   Max.   :28.030  
    ##  TrackerDistance  LoggedActivitiesDistance VeryActiveDistance
    ##  Min.   : 0.000   Min.   :0.0000           Min.   : 0.000    
    ##  1st Qu.: 2.160   1st Qu.:0.0000           1st Qu.: 0.000    
    ##  Median : 4.950   Median :0.0000           Median : 0.100    
    ##  Mean   : 5.192   Mean   :0.1315           Mean   : 1.397    
    ##  3rd Qu.: 7.480   3rd Qu.:0.0000           3rd Qu.: 1.830    
    ##  Max.   :28.030   Max.   :6.7271           Max.   :21.920    
    ##  ModeratelyActiveDistance LightActiveDistance SedentaryActiveDistance
    ##  Min.   :0.0000           Min.   : 0.000      Min.   :0.000000       
    ##  1st Qu.:0.0000           1st Qu.: 1.610      1st Qu.:0.000000       
    ##  Median :0.2000           Median : 3.240      Median :0.000000       
    ##  Mean   :0.5385           Mean   : 3.193      Mean   :0.001704       
    ##  3rd Qu.:0.7700           3rd Qu.: 4.690      3rd Qu.:0.000000       
    ##  Max.   :6.4800           Max.   :12.510      Max.   :0.110000       
    ##  VeryActiveMinutes FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes
    ##  Min.   :  0.00    Min.   :  0.0       Min.   :  0.0        Min.   :   0.0  
    ##  1st Qu.:  0.00    1st Qu.:  0.0       1st Qu.:111.0        1st Qu.: 729.0  
    ##  Median :  2.00    Median :  6.0       Median :195.0        Median :1057.0  
    ##  Mean   : 19.68    Mean   : 13.4       Mean   :185.4        Mean   : 992.5  
    ##  3rd Qu.: 30.00    3rd Qu.: 18.0       3rd Qu.:262.0        3rd Qu.:1244.0  
    ##  Max.   :210.00    Max.   :660.0       Max.   :720.0        Max.   :1440.0  
    ##     Calories   
    ##  Min.   :   0  
    ##  1st Qu.:1799  
    ##  Median :2114  
    ##  Mean   :2266  
    ##  3rd Qu.:2770  
    ##  Max.   :4900

``` r
summary(Combined_weightLog)
```

    ##        Id                Date              WeightKg      WeightPounds  
    ##  Min.   :1.504e+09   Length:100         Min.   : 52.6   Min.   :116.0  
    ##  1st Qu.:6.962e+09   Class :character   1st Qu.: 61.5   1st Qu.:135.6  
    ##  Median :6.962e+09   Mode  :character   Median : 62.5   Median :137.8  
    ##  Mean   :6.834e+09                      Mean   : 72.5   Mean   :159.8  
    ##  3rd Qu.:8.878e+09                      3rd Qu.: 85.3   3rd Qu.:188.1  
    ##  Max.   :8.878e+09                      Max.   :133.5   Max.   :294.3  
    ##                                                                        
    ##       Fat             BMI        IsManualReport      LogId          
    ##  Min.   :10.00   Min.   :21.45   Mode :logical   Min.   :1.459e+12  
    ##  1st Qu.:19.00   1st Qu.:24.00   FALSE:36        1st Qu.:1.460e+12  
    ##  Median :22.00   Median :24.39   TRUE :64        Median :1.461e+12  
    ##  Mean   :19.75   Mean   :25.37                   Mean   :1.461e+12  
    ##  3rd Qu.:22.75   3rd Qu.:25.59                   3rd Qu.:1.462e+12  
    ##  Max.   :25.00   Max.   :47.54                   Max.   :1.463e+12  
    ##  NA's   :96

### After this see that there are columns with insuficient data ( containing mainly nulls or zeros)

### Checking for duplicates

``` r
get_dupes(Combined_dailyActivity)
```

    ## No variable names specified - using all columns.

    ## No duplicate combinations found of: Id, ActivityDate, TotalSteps, TotalDistance, TrackerDistance, LoggedActivitiesDistance, VeryActiveDistance, ModeratelyActiveDistance, LightActiveDistance, ... and 6 other variables

    ## # A tibble: 0 × 16
    ## # ℹ 16 variables: Id <dbl>, ActivityDate <chr>, TotalSteps <dbl>,
    ## #   TotalDistance <dbl>, TrackerDistance <dbl>, LoggedActivitiesDistance <dbl>,
    ## #   VeryActiveDistance <dbl>, ModeratelyActiveDistance <dbl>,
    ## #   LightActiveDistance <dbl>, SedentaryActiveDistance <dbl>,
    ## #   VeryActiveMinutes <dbl>, FairlyActiveMinutes <dbl>,
    ## #   LightlyActiveMinutes <dbl>, SedentaryMinutes <dbl>, Calories <dbl>,
    ## #   dupe_count <int>

``` r
get_dupes(Combined_weightLog)
```

    ## No variable names specified - using all columns.

    ## # A tibble: 4 × 9
    ##           Id Date       WeightKg WeightPounds   Fat   BMI IsManualReport   LogId
    ##        <dbl> <chr>         <dbl>        <dbl> <dbl> <dbl> <lgl>            <dbl>
    ## 1 6962181067 4/12/2016…     62.5         138.    NA  24.4 TRUE           1.46e12
    ## 2 6962181067 4/12/2016…     62.5         138.    NA  24.4 TRUE           1.46e12
    ## 3 8877689391 4/12/2016…     85.8         189.    NA  25.7 FALSE          1.46e12
    ## 4 8877689391 4/12/2016…     85.8         189.    NA  25.7 FALSE          1.46e12
    ## # ℹ 1 more variable: dupe_count <int>

The combined_weightLog data set has 2 duplicates

### Removing duplicates

``` r
Combined_weightLog <- Combined_weightLog[!duplicated(Combined_weightLog), ]
```

recheck for duplicates

``` r
get_dupes(Combined_weightLog)
```

    ## No variable names specified - using all columns.

    ## No duplicate combinations found of: Id, Date, WeightKg, WeightPounds, Fat, BMI, IsManualReport, LogId

    ## # A tibble: 0 × 9
    ## # ℹ 9 variables: Id <dbl>, Date <chr>, WeightKg <dbl>, WeightPounds <dbl>,
    ## #   Fat <dbl>, BMI <dbl>, IsManualReport <lgl>, LogId <dbl>, dupe_count <int>

With that said I will be concentrating specific columns I will be using
for my analysis.

### Removing columns with zeros and NA, like the “Fat” column from the Weight data set

Then removing columns “LoggedActivitiesDistance” and
“SedentaryActiveDistance” from the daily activity data set

``` r
DailyActivity_data <- subset(Combined_dailyActivity, select=-c(LoggedActivitiesDistance,SedentaryActiveDistance))
glimpse(DailyActivity_data)
```

    ## Rows: 1,397
    ## Columns: 13
    ## $ Id                       <dbl> 1503960366, 1503960366, 1503960366, 150396036…
    ## $ ActivityDate             <chr> "3/25/2016", "3/26/2016", "3/27/2016", "3/28/…
    ## $ TotalSteps               <dbl> 11004, 17609, 12736, 13231, 12041, 10970, 122…
    ## $ TotalDistance            <dbl> 7.11, 11.55, 8.53, 8.93, 7.85, 7.16, 7.86, 7.…
    ## $ TrackerDistance          <dbl> 7.11, 11.55, 8.53, 8.93, 7.85, 7.16, 7.86, 7.…
    ## $ VeryActiveDistance       <dbl> 2.57, 6.92, 4.66, 3.19, 2.16, 2.36, 2.29, 3.3…
    ## $ ModeratelyActiveDistance <dbl> 0.46, 0.73, 0.16, 0.79, 1.09, 0.51, 0.49, 0.8…
    ## $ LightActiveDistance      <dbl> 4.07, 3.91, 3.71, 4.95, 4.61, 4.29, 5.04, 3.6…
    ## $ VeryActiveMinutes        <dbl> 33, 89, 56, 39, 28, 30, 33, 47, 40, 15, 43, 3…
    ## $ FairlyActiveMinutes      <dbl> 12, 17, 5, 20, 28, 13, 12, 21, 11, 30, 18, 18…
    ## $ LightlyActiveMinutes     <dbl> 205, 274, 268, 224, 243, 223, 239, 200, 244, …
    ## $ SedentaryMinutes         <dbl> 804, 588, 605, 1080, 763, 1174, 820, 866, 636…
    ## $ Calories                 <dbl> 1819, 2154, 1944, 1932, 1886, 1820, 1889, 186…

``` r
WeightLog_data <- subset(Combined_weightLog, select=-c(Fat,IsManualReport))
glimpse(WeightLog_data)
```

    ## Rows: 98
    ## Columns: 6
    ## $ Id           <dbl> 1503960366, 1927972279, 2347167796, 2873212765, 287321276…
    ## $ Date         <chr> "4/5/2016 11:59:59 PM", "4/10/2016 6:33:26 PM", "4/3/2016…
    ## $ WeightKg     <dbl> 53.3, 129.6, 63.4, 56.7, 57.2, 88.4, 92.4, 69.4, 99.7, 61…
    ## $ WeightPounds <dbl> 117.5064, 285.7191, 139.7731, 125.0021, 126.1044, 194.888…
    ## $ BMI          <dbl> 22.97, 46.17, 24.77, 21.45, 21.65, 25.03, 35.01, 27.14, 2…
    ## $ LogId        <dbl> 1.459901e+12, 1.460313e+12, 1.459728e+12, 1.459987e+12, 1…

``` r
# Removing empty rows and columns
DailyActivity_data <- DailyActivity_data %>% remove_empty(which = c("rows"))
DailyActivity_data <- DailyActivity_data %>% remove_empty(which = c("cols"))
```

``` r
# Removing empty rows and columns
WeightLog_data <- WeightLog_data %>% remove_empty(which = c("rows"))
WeightLog_data <- WeightLog_data %>% remove_empty(which = c("cols"))
```

There are no empty rows or columns for both data sets

### Change the date format for WeightLog_data because it currently has a time attached to the date

``` r
WeightLog_data <- WeightLog_data %>%
  separate(Date, c("date_", "hour"), sep = " ")
```

    ## Warning: Expected 2 pieces. Additional pieces discarded in 98 rows [1, 2, 3, 4, 5, 6, 7,
    ## 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].

``` r
WeightLog_data <- subset(WeightLog_data, select = -c(hour))
head(WeightLog_data)
```

    ## # A tibble: 6 × 6
    ##           Id date_     WeightKg WeightPounds   BMI         LogId
    ##        <dbl> <chr>        <dbl>        <dbl> <dbl>         <dbl>
    ## 1 1503960366 4/5/2016      53.3         118.  23.0 1459900799000
    ## 2 1927972279 4/10/2016    130.          286.  46.2 1460313206000
    ## 3 2347167796 4/3/2016      63.4         140.  24.8 1459727999000
    ## 4 2873212765 4/6/2016      56.7         125.  21.5 1459987199000
    ## 5 2873212765 4/7/2016      57.2         126.  21.6 1460073599000
    ## 6 2891001357 4/5/2016      88.4         195.  25.0 1459900799000

``` r
head(WeightLog_data)
```

    ## # A tibble: 6 × 6
    ##           Id date_     WeightKg WeightPounds   BMI         LogId
    ##        <dbl> <chr>        <dbl>        <dbl> <dbl>         <dbl>
    ## 1 1503960366 4/5/2016      53.3         118.  23.0 1459900799000
    ## 2 1927972279 4/10/2016    130.          286.  46.2 1460313206000
    ## 3 2347167796 4/3/2016      63.4         140.  24.8 1459727999000
    ## 4 2873212765 4/6/2016      56.7         125.  21.5 1459987199000
    ## 5 2873212765 4/7/2016      57.2         126.  21.6 1460073599000
    ## 6 2891001357 4/5/2016      88.4         195.  25.0 1459900799000

``` r
which(is.na(DailyActivity_data))
```

    ## integer(0)

``` r
sum(is.na(DailyActivity_data))
```

    ## [1] 0

``` r
which(is.na(WeightLog_data))
```

    ## integer(0)

``` r
sum(is.na(WeightLog_data))
```

    ## [1] 0

# Analyze Phase

First check for the number of users in each data set

``` r
n_distinct(DailyActivity_data$Id)
```

    ## [1] 35

``` r
n_distinct(WeightLog_data$Id)
```

    ## [1] 13

This shows that there are 35 users entered in the DailyActivity_data but
only 13 users (or data points) in the WeightLog_data. This makes the
Weightlog data pose futher limitations that would reduce the strenght of
my recommendations.

### Clean Names

``` r
colnames(DailyActivity_data)[2] <- "date"
```

``` r
DailyActivity_data <- clean_names(DailyActivity_data)
colnames(DailyActivity_data)
```

    ##  [1] "id"                         "date"                      
    ##  [3] "total_steps"                "total_distance"            
    ##  [5] "tracker_distance"           "very_active_distance"      
    ##  [7] "moderately_active_distance" "light_active_distance"     
    ##  [9] "very_active_minutes"        "fairly_active_minutes"     
    ## [11] "lightly_active_minutes"     "sedentary_minutes"         
    ## [13] "calories"

``` r
WeightLog_data <- clean_names(WeightLog_data)
colnames(WeightLog_data)
```

    ## [1] "id"            "date"          "weight_kg"     "weight_pounds"
    ## [5] "bmi"           "log_id"

### Discoveries from Summarizing data sets

``` r
  summary(DailyActivity_data)
```

    ##        id                date            total_steps    total_distance  
    ##  Min.   :1.504e+09   Length:1397        Min.   :    0   Min.   : 0.000  
    ##  1st Qu.:2.320e+09   Class :character   1st Qu.: 3146   1st Qu.: 2.170  
    ##  Median :4.445e+09   Mode  :character   Median : 6999   Median : 4.950  
    ##  Mean   :4.781e+09                      Mean   : 7281   Mean   : 5.219  
    ##  3rd Qu.:6.962e+09                      3rd Qu.:10544   3rd Qu.: 7.500  
    ##  Max.   :8.878e+09                      Max.   :36019   Max.   :28.030  
    ##  tracker_distance very_active_distance moderately_active_distance
    ##  Min.   : 0.000   Min.   : 0.000       Min.   :0.0000            
    ##  1st Qu.: 2.160   1st Qu.: 0.000       1st Qu.:0.0000            
    ##  Median : 4.950   Median : 0.100       Median :0.2000            
    ##  Mean   : 5.192   Mean   : 1.397       Mean   :0.5385            
    ##  3rd Qu.: 7.480   3rd Qu.: 1.830       3rd Qu.:0.7700            
    ##  Max.   :28.030   Max.   :21.920       Max.   :6.4800            
    ##  light_active_distance very_active_minutes fairly_active_minutes
    ##  Min.   : 0.000        Min.   :  0.00      Min.   :  0.0        
    ##  1st Qu.: 1.610        1st Qu.:  0.00      1st Qu.:  0.0        
    ##  Median : 3.240        Median :  2.00      Median :  6.0        
    ##  Mean   : 3.193        Mean   : 19.68      Mean   : 13.4        
    ##  3rd Qu.: 4.690        3rd Qu.: 30.00      3rd Qu.: 18.0        
    ##  Max.   :12.510        Max.   :210.00      Max.   :660.0        
    ##  lightly_active_minutes sedentary_minutes    calories   
    ##  Min.   :  0.0          Min.   :   0.0    Min.   :   0  
    ##  1st Qu.:111.0          1st Qu.: 729.0    1st Qu.:1799  
    ##  Median :195.0          Median :1057.0    Median :2114  
    ##  Mean   :185.4          Mean   : 992.5    Mean   :2266  
    ##  3rd Qu.:262.0          3rd Qu.:1244.0    3rd Qu.:2770  
    ##  Max.   :720.0          Max.   :1440.0    Max.   :4900

``` r
DailyActivity_data <- DailyActivity_data %>% mutate( Weekday = weekdays(as.Date(date, "%m/%d/%Y")))

view(DailyActivity_data)
```

``` r
ggplot(data=DailyActivity_data, aes(x=Weekday, y=total_steps))+
  geom_bar(stat= "identity", fill="darksalmon")
```

![](Bellabeat-Project-with-R_files/figure-gfm/plotting%20the%20activity%20trend%20compared%20to%20day%20of%20the%20week-1.png)<!-- -->

``` r
summary(DailyActivity_data)
```

    ##        id                date            total_steps    total_distance  
    ##  Min.   :1.504e+09   Length:1397        Min.   :    0   Min.   : 0.000  
    ##  1st Qu.:2.320e+09   Class :character   1st Qu.: 3146   1st Qu.: 2.170  
    ##  Median :4.445e+09   Mode  :character   Median : 6999   Median : 4.950  
    ##  Mean   :4.781e+09                      Mean   : 7281   Mean   : 5.219  
    ##  3rd Qu.:6.962e+09                      3rd Qu.:10544   3rd Qu.: 7.500  
    ##  Max.   :8.878e+09                      Max.   :36019   Max.   :28.030  
    ##  tracker_distance very_active_distance moderately_active_distance
    ##  Min.   : 0.000   Min.   : 0.000       Min.   :0.0000            
    ##  1st Qu.: 2.160   1st Qu.: 0.000       1st Qu.:0.0000            
    ##  Median : 4.950   Median : 0.100       Median :0.2000            
    ##  Mean   : 5.192   Mean   : 1.397       Mean   :0.5385            
    ##  3rd Qu.: 7.480   3rd Qu.: 1.830       3rd Qu.:0.7700            
    ##  Max.   :28.030   Max.   :21.920       Max.   :6.4800            
    ##  light_active_distance very_active_minutes fairly_active_minutes
    ##  Min.   : 0.000        Min.   :  0.00      Min.   :  0.0        
    ##  1st Qu.: 1.610        1st Qu.:  0.00      1st Qu.:  0.0        
    ##  Median : 3.240        Median :  2.00      Median :  6.0        
    ##  Mean   : 3.193        Mean   : 19.68      Mean   : 13.4        
    ##  3rd Qu.: 4.690        3rd Qu.: 30.00      3rd Qu.: 18.0        
    ##  Max.   :12.510        Max.   :210.00      Max.   :660.0        
    ##  lightly_active_minutes sedentary_minutes    calories      Weekday         
    ##  Min.   :  0.0          Min.   :   0.0    Min.   :   0   Length:1397       
    ##  1st Qu.:111.0          1st Qu.: 729.0    1st Qu.:1799   Class :character  
    ##  Median :195.0          Median :1057.0    Median :2114   Mode  :character  
    ##  Mean   :185.4          Mean   : 992.5    Mean   :2266                     
    ##  3rd Qu.:262.0          3rd Qu.:1244.0    3rd Qu.:2770                     
    ##  Max.   :720.0          Max.   :1440.0    Max.   :4900

# Visualization in R

### Daily Usage

``` r
Avg_steps <- DailyActivity_data %>%
  summarise(Avg_steps_per_day = mean(total_steps))
as_tibble(Avg_steps)
```

    ## # A tibble: 1 × 1
    ##   Avg_steps_per_day
    ##               <dbl>
    ## 1             7281.

``` r
Avg_burned_calories <- DailyActivity_data %>%
  summarise(Avg_calories_burned_per_day = mean(calories))
as_tibble(Avg_burned_calories)
```

    ## # A tibble: 1 × 1
    ##   Avg_calories_burned_per_day
    ##                         <dbl>
    ## 1                       2266.

According to data found through MedicineNet.come, An article on how to
measure physical activity points out the follow: -Sedentary: Less than
5,000 steps daily -Low active: About 5,000 to 7,499 steps daily
-Somewhat active: About 7,500 to 9,999 steps daily -Active: More than
10,000 steps daily -Highly active: More than 12,500 steps daily Mayo
Clinic, The U.S. Department of Health and Human Services recommends 150
minutes of exercise as moderate-intensity exercise, such as brisk
walking, each week.

``` r
DailyActivity_data$activity_type <-  as.factor(ifelse(
  DailyActivity_data$total_steps < 5000, "Sedentary active",
                                            ifelse(
  DailyActivity_data$total_steps < 7500, "Light active",
                                            ifelse(
  DailyActivity_data$total_steps < 10000, "Moderately active",
                                            ifelse(
  DailyActivity_data$total_steps < 40000, "Very active",
                                            )))))
head(DailyActivity_data)
```

    ## # A tibble: 6 × 15
    ##        id date  total_steps total_distance tracker_distance very_active_distance
    ##     <dbl> <chr>       <dbl>          <dbl>            <dbl>                <dbl>
    ## 1  1.50e9 3/25…       11004           7.11             7.11                 2.57
    ## 2  1.50e9 3/26…       17609          11.6             11.6                  6.92
    ## 3  1.50e9 3/27…       12736           8.53             8.53                 4.66
    ## 4  1.50e9 3/28…       13231           8.93             8.93                 3.19
    ## 5  1.50e9 3/29…       12041           7.85             7.85                 2.16
    ## 6  1.50e9 3/30…       10970           7.16             7.16                 2.36
    ## # ℹ 9 more variables: moderately_active_distance <dbl>,
    ## #   light_active_distance <dbl>, very_active_minutes <dbl>,
    ## #   fairly_active_minutes <dbl>, lightly_active_minutes <dbl>,
    ## #   sedentary_minutes <dbl>, calories <dbl>, Weekday <chr>, activity_type <fct>

### Including Plots

``` r
DailyusagebyactivityLevel <- DailyActivity_data %>% 
  group_by(date, )
```

``` r
Daily_Use_Viz <- ggplot(DailyActivity_data, 
                    aes(x=activity_type, y=total_steps, fill=activity_type)) +
  geom_point() +
  theme_minimal() +
  labs(title="User Daily Activity Compared to Number of Steps per day", 
       x="Activity Type", y="Total Number of Steps",
       caption = "FitBit Fitness Tracker Data (CC0: Public Domain, dataset made available through Mobius)") + 
  scale_fill_discrete(name = "Daily activity") +
  theme(plot.title = element_text(face = "bold"))
plot(Daily_Use_Viz)
```

![](Bellabeat-Project-with-R_files/figure-gfm/Daily%20activity%20frequency-1.png)<!-- -->

## creating tables to use for tableau visualizations

``` r
Activity_type <- c("Sedentary", "Very_active", "Fairly_active", "Lightly_active")
 
Percentages <- c('81.33','1.74','1.11','15.82')

Avtivity_type_total <- data.frame(Activity_type, Percentages)
```

``` r
write.csv(Avtivity_type_total, file = "Avtivity_type_total.csv")
```

### Daily Activity levels

``` r
summary(DailyActivity_data)
```

    ##        id                date            total_steps    total_distance  
    ##  Min.   :1.504e+09   Length:1397        Min.   :    0   Min.   : 0.000  
    ##  1st Qu.:2.320e+09   Class :character   1st Qu.: 3146   1st Qu.: 2.170  
    ##  Median :4.445e+09   Mode  :character   Median : 6999   Median : 4.950  
    ##  Mean   :4.781e+09                      Mean   : 7281   Mean   : 5.219  
    ##  3rd Qu.:6.962e+09                      3rd Qu.:10544   3rd Qu.: 7.500  
    ##  Max.   :8.878e+09                      Max.   :36019   Max.   :28.030  
    ##  tracker_distance very_active_distance moderately_active_distance
    ##  Min.   : 0.000   Min.   : 0.000       Min.   :0.0000            
    ##  1st Qu.: 2.160   1st Qu.: 0.000       1st Qu.:0.0000            
    ##  Median : 4.950   Median : 0.100       Median :0.2000            
    ##  Mean   : 5.192   Mean   : 1.397       Mean   :0.5385            
    ##  3rd Qu.: 7.480   3rd Qu.: 1.830       3rd Qu.:0.7700            
    ##  Max.   :28.030   Max.   :21.920       Max.   :6.4800            
    ##  light_active_distance very_active_minutes fairly_active_minutes
    ##  Min.   : 0.000        Min.   :  0.00      Min.   :  0.0        
    ##  1st Qu.: 1.610        1st Qu.:  0.00      1st Qu.:  0.0        
    ##  Median : 3.240        Median :  2.00      Median :  6.0        
    ##  Mean   : 3.193        Mean   : 19.68      Mean   : 13.4        
    ##  3rd Qu.: 4.690        3rd Qu.: 30.00      3rd Qu.: 18.0        
    ##  Max.   :12.510        Max.   :210.00      Max.   :660.0        
    ##  lightly_active_minutes sedentary_minutes    calories      Weekday         
    ##  Min.   :  0.0          Min.   :   0.0    Min.   :   0   Length:1397       
    ##  1st Qu.:111.0          1st Qu.: 729.0    1st Qu.:1799   Class :character  
    ##  Median :195.0          Median :1057.0    Median :2114   Mode  :character  
    ##  Mean   :185.4          Mean   : 992.5    Mean   :2266                     
    ##  3rd Qu.:262.0          3rd Qu.:1244.0    3rd Qu.:2770                     
    ##  Max.   :720.0          Max.   :1440.0    Max.   :4900                     
    ##            activity_type
    ##  Light active     :254  
    ##  Moderately active:213  
    ##  Sedentary active :500  
    ##  Very active      :430  
    ##                         
    ## 

``` r
Daily_minutes <- DailyActivity_data %>%
  reframe(Avgsedentary = mean(sedentary_minutes)) 
```

``` r
Active_type <- c("Sedentary", "Very_active", "Fairly_active", "Lightly_active")
 
# took the mean of each activity's total minutes

Total_minutes <- c('992.5','19.68','13.4','185.4')

# To get the percentage divide each mean by the total of all the means (1210.98), then multiply by 100


# Total_percent <- c('((992.5/1210.98)*100)', '((19.68/1210.98)*100)', '((13.4/1210.98)*100)', '((185.4/1210.98)*100))') 

Total_percent <- c('81.95', '1.62', '1.11', '15.31')


Total_Active_minutes <- data.frame(Activity_type, Total_minutes, Total_percent)

head(Total_Active_minutes)
```

    ##    Activity_type Total_minutes Total_percent
    ## 1      Sedentary         992.5         81.95
    ## 2    Very_active         19.68          1.62
    ## 3  Fairly_active          13.4          1.11
    ## 4 Lightly_active         185.4         15.31

``` r
library(ggrepel)
library(readr)

activitypercent  <- data.frame(value <- c(1.11, 1.62, 81.95, 15.31),
group = paste0("A", 1:4))


# Get the positions
newactivitypercent <- activitypercent %>% 
  mutate(csum = rev(cumsum(rev(value))), 
         pos = value/2 + lead(csum, 1),
         pos = if_else(is.na(pos), value/2, pos))

ggplot(activitypercent, aes(x = "" , y = value, fill = fct_inorder(group))) +
  geom_col(width = 1, color = 1) +
  coord_polar(theta = "y") +
  scale_fill_brewer(palette = "pastelgradient") +
  geom_label_repel(data = newactivitypercent,
                   aes(y = pos, label = paste0(value, "%")),
                   size = 4.5, nudge_x = 1, show.legend = FALSE) +
  guides(fill = guide_legend(title = "Activity level")) +
   scale_fill_discrete(name = "Activity level", labels = c("Fairly_active", "Very_active", "Sedentary", "Light_active")) +
  theme_void()
```

    ## Warning: Unknown palette: "pastelgradient"

    ## Scale for fill is already present.
    ## Adding another scale for fill, which will replace the existing scale.

![](Bellabeat-Project-with-R_files/figure-gfm/Setting%20up%20new%20table%20from%20information%20above-1.png)<!-- -->

``` r
write.csv(Total_Active_minutes, file = "Total_Active_minutes.csv")
```

``` r
write.csv(DailyActivity_data, file = "DailyActivity_Data.csv")
```

``` r
 Week_day <- c("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday")
               
Average_steps <- c('6454','11241','10936','9115','8108','8376','11357')

Avgstepperday <- data.frame(Week_day, Average_steps)               
```

``` r
write.csv(Avgstepperday, file = "Avgstepperday.csv")
```
